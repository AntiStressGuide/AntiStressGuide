<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enhanced Stress Index (WHO-Based)</title>

<link rel="icon" type="image/png" href="Logo AntiStressGuide.png">
<link rel="shortcut icon" type="image/x-icon" href="Logo AntiStressGuide.ico">
<link rel="apple-touch-icon" sizes="180x180" href="Logo AntiStressGuide.png">

<style>
body { font-family: Roboto, Arial, sans-serif; background:#eaf5e8; margin:0; padding:0; line-height:1.6; }
.container { max-width:800px; margin:30px auto; background:#fff; padding:30px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
.header { display:flex; align-items:center; justify-content:space-between; margin-bottom:20px; background:#f7fff8; padding:10px 20px; border-radius:10px 10px 0 0; }
.header img.logo { height:50px; width:auto; }
.header nav a { margin-left:15px; text-decoration:underline; color:#007bff; font-weight:bold; }
.header nav a:hover { color:#27623e; }

h1,h2 { text-align:center; color:#2E5D3D; }

.question { margin:15px 0; padding:15px; border-radius:8px; }
.question:nth-child(odd){ background:#e0f2e9; }
.question:nth-child(even){ background:#f7fff8; }

label { display:block; margin:5px 0; font-size:18px; }
input[type="range"] { width:100%; margin-top:5px; }
.range-labels { display:flex; justify-content:space-between; font-size:14px; color:#555; margin-top:5px; }
input[type="checkbox"], input[type="radio"] { margin-right:10px; transform:scale(1.3); }
select, input[type=email] { width:100%; padding:12px; margin-top:10px; border-radius:30px; border:1px solid #ccc; font-size:18px; }
button { margin-top:10px; padding:12px 25px; color:#fff; background:#2E5D3D; border:none; border-radius:5px; cursor:pointer; font-size:16px; }
button:hover{ background:#27623e; }

.submit-container { display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap; }
.submit-container button { flex:1; text-align:center; }

#results { display:none; margin-top:20px; text-align:center; padding:20px; background:#e0f2e9; border-radius:10px; }

.bar-container { width:100%; background:#d9f0e0; border-radius:10px; margin:10px 0; height:25px; }
.bar { height:100%; border-radius:10px; text-align:right; padding-right:5px; color:#fff; font-weight:bold; line-height:25px; }

footer { margin-top:40px; padding:20px; font-size:0.9em; color:#444; text-align:center; border-top:1px solid #cce6d0; }
@media (max-width: 600px){ .header { flex-direction:column; align-items:center; } .header nav { margin-top:10px; } }
.action { background:#2E5D3D; color:#fff; padding:12px 25px; border:none; border-radius:5px; cursor:pointer; font-size:16px; }
.action:hover { background:#27623e; }
</style>
</head>
<body>

<div class="container">

<div class="header">
  <img src="Logo AntiStressGuide.png" alt="AntiStressGuide Logo" class="logo">
  <nav>
    <a href="index.html">Home</a>
    <a href="Recommendations.html">Recommendations</a>
  </nav>
</div>

<h1>Enhanced Stress Index (WHO-Based)</h1>

<form id="assessmentForm">

<h2>Demographics</h2>
<div class="question">
  <label>Age:</label>
  <select name="age" required>
    <option value="" disabled selected>Select age</option>
    <option value="18-30">18â€“30</option>
    <option value="31-50">31â€“50</option>
    <option value="51-70">51â€“70</option>
    <option value=">70">>70</option>
  </select>
</div>

<div class="question">
  <label>Gender:</label>
  <select name="gender" required>
    <option value="" disabled selected>Select gender</option>
    <option value="Male">Male</option>
    <option value="Female">Female</option>
    <option value="Other">Other</option>
  </select>
</div>

<h2>Medical Conditions</h2>
<div class="question">
  <label>Do you have any chronic diseases, medical conditions, or recent surgeries?</label>
  <label><input type="checkbox" name="medical" value="None"> None</label>
  <label><input type="checkbox" name="medical" value="Cardiovascular Disease"> Cardiovascular Disease</label>
  <label><input type="checkbox" name="medical" value="Mental Health Condition"> Mental Health Condition</label>
  <label><input type="checkbox" name="medical" value="Recent Surgery"> Recent Surgery</label>
  <label><input type="checkbox" name="medical" value="Other"> Other</label>
</div>

<h2>Nutrition (0â€“4, positive framing)</h2>
<div class="question">
  <label>How healthy is your diet?</label>
  <label><input type="radio" name="nutrition" value="0" required> Very unhealthy: sugar>15%, salt>10g/day, saturated fat>15%</label>
  <label><input type="radio" name="nutrition" value="1"> Unhealthy: sugar 10â€“15%, salt 7â€“10g, saturated fat 10â€“15%</label>
  <label><input type="radio" name="nutrition" value="2"> Average: sugar 5â€“10%, salt 5â€“7g, saturated fat 7â€“10%</label>
  <label><input type="radio" name="nutrition" value="3"> Healthy: sugar 5â€“7%, salt 3â€“5g, saturated fat 5â€“7%</label>
  <label><input type="radio" name="nutrition" value="4"> Very healthy: sugar<5%, salt<3g, saturated fat<5%</label>
</div>

<h2>Physical Activity</h2>
<div class="question">
  <label>Weekly Physical Activity:</label>
  <label><input type="radio" name="physical" value="0" required>&lt;150 min/week, no strength</label>
  <label><input type="radio" name="physical" value="1">150â€“300 min/week, 0â€“1 strength</label>
  <label><input type="radio" name="physical" value="2">150â€“300 min/week, 2+ strength</label>
  <label><input type="radio" name="physical" value="3">&gt;300 min/week, 2+ strength</label>
  <label><input type="radio" name="physical" value="4">Vigorous 75â€“150+ min/week</label>
</div>

<h2>Harmful Habits</h2>
<div class="question">
  <label>Alcohol consumption</label>
  <label><input type="radio" name="alcohol" value="0" required> None (0 drinks/week)</label>
  <label><input type="radio" name="alcohol" value="1"> Low risk (Women: 1â€“7, Men: 1â€“14/week)</label>
  <label><input type="radio" name="alcohol" value="2"> Moderate risk (Women: 8â€“14, Men: 15â€“28/week)</label>
  <label><input type="radio" name="alcohol" value="3"> High risk (Women: 15â€“21, Men: 29â€“42/week)</label>
  <label><input type="radio" name="alcohol" value="4"> Very high (Women: 21+, Men: 42+/week)</label>
</div>

<div class="question">
  <label>Tobacco use</label>
  <label><input type="radio" name="tobacco" value="0" required> None</label>
  <label><input type="radio" name="tobacco" value="1"> Low (&lt;5/day)</label>
  <label><input type="radio" name="tobacco" value="2"> Moderate (5â€“19/day)</label>
  <label><input type="radio" name="tobacco" value="3"> High (20/day)</label>
  <label><input type="radio" name="tobacco" value="4"> Very high (â‰¥30/day)</label>
</div>

<div class="question">
  <label>Drug use</label>
  <label><input type="radio" name="drugs" value="0" required> None</label>
  <label><input type="radio" name="drugs" value="1"> Low (occasional)</label>
  <label><input type="radio" name="drugs" value="2"> Moderate (regular, some risk)</label>
  <label><input type="radio" name="drugs" value="3"> High (dependence / health risk)</label>
  <label><input type="radio" name="drugs" value="4"> Very high (severe)</label>
</div>

<div class="question">
  <label>Gambling</label>
  <label><input type="radio" name="gambling" value="0" required> None</label>
  <label><input type="radio" name="gambling" value="1"> Low (occasional, minimal problems)</label>
  <label><input type="radio" name="gambling" value="2"> Moderate (regular, some problems)</label>
  <label><input type="radio" name="gambling" value="3"> High (frequent, significant problems)</label>
  <label><input type="radio" name="gambling" value="4"> Very high (pathological)</label>
</div>

<h2>Stress (0â€“4 Likert)</h2>
<div id="questions"></div>

<div class="submit-container">
  <button type="submit" name="action" value="index"><b>Submit for <br>Index Value</b></button>
  <button type="submit" name="action" value="individual"><b>Submit for <br>Individual Recommendations</b></button>
</div>

</form>

<div id="results">
  <p id="responseID"></p>
  <p id="totalPoints"></p>
  <p id="categoryColor"></p>
  <div id="breakdown"></div>
  <div id="barChart"></div>
  <button id="newFormBtn" class="action">Fill Out Again</button>
</div>

<footer>&copy; 2025 AntiStressGuide. All rights reserved.</footer>

<script>
const likertLabels = ["Never","Rarely","Sometimes","Often","Very Often"];
const stressQuestions = [
  "In the past month, I felt that things were generally going my way.",
  "During the last month, I felt confident about handling personal problems.",
  "Over the past month, I felt physically and mentally healthy enough to meet daily demands.",
  "In the past month, I was satisfied with my overall well-being and quality of life.",
  "During the last month, I felt energetic and capable of handling both work and personal responsibilities.",
  "Over the past month, I could take breaks and recover adequately during and between workdays.",
  "In the last month, support from colleagues helped me cope with stress.",
  "During the past month, my work schedule allowed me to maintain a healthy work-life balance.",
  "Over the last month, my workload prevented me from completing important personal tasks.",
  "In the past month, I had sufficient control over how I completed my work tasks."
];

const questionsDiv = document.getElementById('questions');
stressQuestions.forEach((q,i)=>{
  const div=document.createElement('div');
  div.className='question';
  div.innerHTML=`<label>${i+1}. ${q}</label>
  <input type="range" min="0" max="4" value="2" name="q${i}" required>
  <div class="range-labels">${likertLabels.map(l=>`<span>${l}</span>`).join('')}</div>`;
  questionsDiv.appendChild(div);
});

function generateSequentialID() {
  const now=new Date();
  const yearMonth=`${now.getFullYear()}${String(now.getMonth()+1).padStart(2,'0')}`;
  let currentNumber=parseInt(localStorage.getItem(`internalID_${yearMonth}`)||"0",10);
  currentNumber+=1;
  localStorage.setItem(`internalID_${yearMonth}`,currentNumber);
  return `ASG${yearMonth}${String(currentNumber).padStart(4,'0')}`;
}

function avg(arr){ const nums=arr.map(Number).filter(n=>!isNaN(n)); return nums.length?nums.reduce((a,b)=>a+b,0)/nums.length:0; }

const form = document.getElementById('assessmentForm');
form.addEventListener('submit', e=>{
  e.preventDefault();
  const responseID = generateSequentialID();

  const stressAnswers = stressQuestions.map((q,i)=>parseInt(form.querySelector(`input[name="q${i}"]`).value));
  const stressScore = avg(stressAnswers);

  const habitsValues = ["alcohol","tobacco","drugs","gambling"].map(name=>parseInt(form.querySelector(`input[name="${name}"]:checked`).value));
  const habitsScore = avg(habitsValues);

  const physicalScore = parseInt(form.querySelector('input[name="physical"]:checked')?.value || 0);
  const nutritionScore = parseInt(form.querySelector('input[name="nutrition"]:checked')?.value || 0);

  const medicalList = Array.from(form.querySelectorAll('input[name="medical"]:checked')).map(c=>c.value).filter(v=>v!=="None");
  const medicalScore = Math.min(4, medicalList.length);

  const totalScore = (stressScore + habitsScore + medicalScore + nutritionScore - physicalScore).toFixed(2);

  let category="", color="";
  if(totalScore < 0.5){ category="Excellent / Low Risk"; color="ðŸŸ¢"; }
  else if(totalScore < 1.5){ category="Mild Risk"; color="ðŸŸ¡"; }
  else if(totalScore < 2.5){ category="Elevated Risk"; color="ðŸŸ "; }
  else{ category="High / Very High Risk"; color="ðŸ”´"; }

  form.style.display='none';
  const resultsDiv=document.getElementById('results');
  resultsDiv.style.display='block';
  document.getElementById('responseID').textContent=`Response ID: ${responseID}`;
  document.getElementById('totalPoints').textContent=`Total Score: ${totalScore}`;
  document.getElementById('categoryColor').textContent=`Category: ${category} ${color}`;

  document.getElementById('breakdown').innerHTML=`<b>Breakdown:</b><br>
    Stress: ${stressScore.toFixed(2)}<br>
    Habits: ${habitsScore.toFixed(2)}<br>
    Medical: ${medicalScore.toFixed(2)}<br>
    Nutrition: ${nutritionScore.toFixed(2)}<br>
    Physical Activity (protective): ${physicalScore.toFixed(2)}
  `;

  const barChart = document.getElementById('barChart');
  barChart.innerHTML='';
  const sections = [
    {label:"Stress", value:stressScore, color:"#ff6347"},
    {label:"Habits", value:habitsScore, color:"#ff6347"},
    {label:"Medical", value:medicalScore, color:"#ff6347"},
    {label:"Nutrition", value:nutritionScore, color:"#ff6347"},
    {label:"Physical Activity", value:physicalScore, color:"#2E5D3D"}
  ];
  sections.f
